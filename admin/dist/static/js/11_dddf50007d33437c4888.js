(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{593:function(t,e,a){"use strict";a.d(e,"a",function(){return s}),a.d(e,"b",function(){return n});const s=10,n="登录过期，请重新登录"},596:function(t,e,a){"use strict";var s=a(602),n=a.n(s),i=a(603),r=a.n(i),l=a(604),o=a.n(l),d=a(139);const c=new RegExp(d.a.allowUrls),u=new RegExp(d.a.noJsonTypeUrls);function p(t){if(!c.test(t)){let e=localStorage.getItem("malltoken");return u.test(t)?{token:e}:{token:e,"Content-Type":"application/json;charset=UTF-8"}}return u.test(t)?{}:{"Content-Type":"application/json;charset=UTF-8"}}function h(t){return o.a.done(),{data:{status:t.status,data:t.data}}}n.a.interceptors.request.use(t=>(o.a.start(),t),t=>Promise.reject(t)),n.a.interceptors.response.use(t=>t,t=>Promise.resolve(t.response)),e.a={post:(t,e)=>n()({method:"post",url:d.a.base_api_host+t,data:JSON.stringify(e),timeout:3e4,headers:p(t)}).then(h).catch(function(t){return t}),get:(t,e)=>n()({method:"get",url:d.a.base_api_host+t,params:e,timeout:3e4,headers:p(t)}).then(h).catch(function(t){return console.log(t),t}),delete:(t,e)=>n()({method:"delete",url:d.a.base_api_host+t,params:e,timeout:3e4,headers:p(t)}).then(h).catch(function(t){return console.log(t),t}),put:(t,e)=>n()({method:"put",url:d.a.base_api_host+t,data:JSON.stringify(e),timeout:3e4,headers:p(t)}).then(h).catch(function(t){return console.log(t),t}),formPost:(t,e)=>n()({method:"post",url:d.a.base_api_host+t,data:r.a.stringify(e),timeout:3e4,headers:p(t)}).then(h)}},597:function(t,e,a){"use strict";a.d(e,"a",function(){return i});var s=a(593);const n=a(605),i=(t,e,a)=>(t.actionStatus&&(t.actionStatus=!1),e===n.OK||(e===n.NOT_FOUND?(t.$message({message:"请求不存在",type:"error"}),!1):e===n.UNAUTHORIZED?(t.$message({message:a,type:"error"}),!1):e===n.FORBIDDEN?(t.$message({message:s.b,type:"warning",duration:2e3,onClose:()=>{localStorage.removeItem("malluser"),localStorage.removeItem("malltoken"),localStorage.removeItem("mallfilePath"),t.$router.replace({path:"/login"})}}),!1):(t.$message({message:"服务器出错",type:"error"}),!1)))},610:function(t,e,a){"use strict";a.d(e,"f",function(){return n}),a.d(e,"a",function(){return i}),a.d(e,"b",function(){return r}),a.d(e,"e",function(){return l}),a.d(e,"d",function(){return o}),a.d(e,"g",function(){return d}),a.d(e,"c",function(){return c});var s=a(596);const n=t=>s.a.get("product",t).then(t=>t.data),i=t=>s.a.post("admin/product",t).then(t=>t.data),r=t=>s.a.delete(`admin/product/${t}`).then(t=>t.data),l=t=>s.a.get(`product/${t}`).then(t=>t.data),o=(t,e)=>s.a.put(`admin/product/${t}`,e).then(t=>t.data),d=(t,e)=>s.a.put(`admin/product/${t}/updateRecommend`,e).then(t=>t.data),c=t=>s.a.delete(`admin/specifications/${t}`).then(t=>t.data)},630:function(t,e,a){"use strict";a.d(e,"e",function(){return n}),a.d(e,"a",function(){return i}),a.d(e,"c",function(){return r}),a.d(e,"g",function(){return l}),a.d(e,"f",function(){return o}),a.d(e,"b",function(){return d}),a.d(e,"d",function(){return c}),a.d(e,"h",function(){return u});var s=a(596);const n=t=>s.a.get("brand",t).then(t=>t.data),i=t=>s.a.post("admin/brand",t).then(t=>t.data),r=t=>s.a.delete(`admin/brand/${t}`).then(t=>t.data),l=(t,e)=>s.a.put(`admin/brand/${t}`,e).then(t=>t.data),o=t=>s.a.get("goods-type",t).then(t=>t.data),d=t=>s.a.post("admin/goods-type",t).then(t=>t.data),c=t=>s.a.delete(`admin/goods-type/${t}`).then(t=>t.data),u=(t,e)=>s.a.put(`admin/goods-type/${t}`,e).then(t=>t.data)},633:function(t,e,a){},738:function(t,e,a){"use strict";var s=a(633);a.n(s).a},851:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"brand-cointer"},[a("div",{staticClass:"cointer-box"},[a("div",{staticClass:"brand-content"},[a("div",{staticClass:"header"},[a("div",[t._v("品牌")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){e.preventDefault(),t.addBrand()}}},[t._v("\n          新增\n        ")])],1),t._v(" "),a("div",{staticClass:"brand-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.brandList,height:"250","highlight-current-row":""},on:{"current-change":t.brandChange}},[a("el-table-column",{attrs:{prop:"name",align:"center",label:"名称",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.editBrand(e.$index,e.row)}}},[t._v("\n                编辑\n              ")]),t._v(" "),a("el-button",{staticClass:"danger",attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.deleteBrand(e.$index,e.row,t.brandList)}}},[t._v("\n                删除\n              ")])]}}])})],1)],1)]),t._v(" "),a("div",{staticClass:"type-content"},[a("div",{staticClass:"header"},[a("div",[t._v("类型")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){e.preventDefault(),t.addType()}}},[t._v("\n          新增\n        ")])],1),t._v(" "),a("div",{staticClass:"brand-table"},[a("el-table",{ref:"brandTable",staticStyle:{width:"100%"},attrs:{data:t.typeList,height:"250","highlight-current-row":""},on:{"current-change":t.typeChange}},[a("el-table-column",{attrs:{prop:"name",label:"名称",width:"150",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.editType(e.$index,e.row)}}},[t._v("\n                编辑\n              ")]),t._v(" "),a("el-button",{staticClass:"danger",attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.deleteType(e.$index,e.row,t.typeList)}}},[t._v("\n                删除\n              ")])]}}])})],1)],1)]),t._v(" "),a("div",{staticClass:"goods-content"},[a("div",{staticClass:"header"},[a("div",[t._v("商品")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){e.preventDefault(),t.editProduct()}}},[t._v("\n          新增\n        ")])],1),t._v(" "),a("div",{staticClass:"goods-content"},[a("ul",{staticClass:"goods-ul clear"},t._l(t.productList,function(e,s){return a("li",{key:s},[a("div",{staticClass:"card"},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("div",{staticClass:"img-base",style:{"background-image":"url("+(t.filePath+e.cover)+")"}},[1===e.recommend?a("i",{staticClass:"el-icon-star-on"}):t._e()]),t._v(" "),a("div",{staticClass:"card-bottom"},[a("span",[t._v(t._s(e.title))]),t._v(" "),a("div",{staticClass:"bottom clear"},[a("time",{staticClass:"time"},[t._v(t._s(t._f("dateFilter")(e.create_time)))]),t._v(" "),a("el-button",{staticClass:"button",attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),t.editProduct(e.id)}}},[t._v("修改")])],1)])])],1)])}))])])]),t._v(" "),a("el-dialog",{attrs:{title:"品牌编辑",width:"60%",visible:t.brandStatus},on:{"update:visible":function(e){t.brandStatus=e},close:t.formClose}},[a("el-form",{ref:"brandForm",staticClass:"dialog-form",attrs:{model:t.brandModel,rules:t.brandRules}},[a("el-form-item",{attrs:{label:"名称","label-width":"120px",prop:"name"}},[a("el-input",{staticStyle:{width:"70%","max-width":"400px"},model:{value:t.brandModel.name,callback:function(e){t.$set(t.brandModel,"name",e)},expression:"brandModel.name"}})],1),t._v(" "),a("div",{staticClass:"formModel el-form-item clear",staticStyle:{position:"relative","padding-left":"120px"}},[a("label",{staticClass:"el-form-item__label",staticStyle:{width:"120px",position:"absolute",left:"0"}},[t._v("缩略图")]),t._v(" "),a("div",{},[a("el-upload",{staticClass:"avatar-uploader",attrs:{headers:t.headers,"show-file-list":!1,accept:"image/*",action:t.sealImgAction,"on-success":t.handleAvatarSuccess}},[t.imgUrl?a("img",{staticClass:"avatar",attrs:{src:t.imgUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.cancelBrand()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.sureBrand()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"类型编辑",width:"60%",visible:t.typeStatus},on:{"update:visible":function(e){t.typeStatus=e},close:t.formClose}},[a("el-form",{ref:"typeForm",staticClass:"dialog-form",attrs:{model:t.typeModel,rules:t.typeRules}},[a("el-form-item",{attrs:{label:"品牌","label-width":"120px",prop:"name"}},[a("el-select",{staticStyle:{width:"70%","max-width":"400px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.typeModel.brand_id,callback:function(e){t.$set(t.typeModel,"brand_id",e)},expression:"typeModel.brand_id"}},t._l(t.brandList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"名称","label-width":"120px",prop:"name"}},[a("el-input",{staticStyle:{width:"70%","max-width":"400px"},model:{value:t.typeModel.name,callback:function(e){t.$set(t.typeModel,"name",e)},expression:"typeModel.name"}})],1),t._v(" "),a("div",{staticClass:"formModel el-form-item clear",staticStyle:{position:"relative","padding-left":"120px"}},[a("label",{staticClass:"el-form-item__label",staticStyle:{width:"120px",position:"absolute",left:"0"}},[t._v("缩略图")]),t._v(" "),a("div",{},[a("el-upload",{staticClass:"avatar-uploader",attrs:{headers:t.headers,"show-file-list":!1,accept:"image/*",action:t.sealImgAction,"on-success":t.handleTypeSuccess}},[t.imgTypeUrl?a("img",{staticClass:"avatar",attrs:{src:t.imgTypeUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.cancelType()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.sureType()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)};s._withStripped=!0;var n=a(630),i=a(610),r=a(597),l=a(139);a(593);a(1);var o,d={data:()=>({filePath:"",imgUrl:"",imgTypeUrl:"",brandList:[],typeList:[],shopList:[],productList:[],brandStatus:!1,typeStatus:!1,brandModel:{},typeModel:{brand_id:""},selBrandId:"",selTypeId:"",headers:{},dialogVisible:!1,dialogImageUrl:"",sealImgAction:`${l.a.base_api_host}admin/uploadDisk`,brandRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]},typeRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],brand_id:[{required:!0,message:"请选择品牌",trigger:"blur"}]}}),computed:{},components:{},mounted(){o=this.$loading({target:".content-container",lock:!0,background:"rgba(255, 255, 255, 0.74)"}),this.filePath=localStorage.getItem("mallfilePath");const t=localStorage.getItem("malltoken");this.headers={token:t},this.getBrandList(),this.getTypeList(),this.getProductList()},filters:{},methods:{getBrandList(){const t=this;n.e().then(function(e){const{data:a,status:s}=e;Object(r.a)(t,s,a)&&(t.brandList=a)})},deleteBrand(t,e,a){const s=this;this.$confirm("将同时删除对应的商品，确认删除吗?","提示",{}).then(()=>{n.c(e.id).then(function(e){const{data:n,status:i}=e;Object(r.a)(s,i,n)&&a.splice(t,1)})}).catch(()=>{})},deleteType(t,e,a){const s=this;this.$confirm("将同时删除对应的商品，确认删除吗?","提示",{}).then(()=>{n.d(e.id).then(function(e){const{data:n,status:i}=e;Object(r.a)(s,i,n)&&a.splice(t,1)})})},getTypeList(){const t=this;let e={brand_id:this.selBrandId};n.f(e).then(function(e){const{data:a,status:s}=e;Object(r.a)(t,s,a)&&(t.typeList=a)})},getProductList(){const t=this;let e={brand_id:this.selBrandId,type_id:this.selTypeId};Object(i.f)(e).then(function(e){const{data:a,status:s}=e;Object(r.a)(t,s,a)&&(o.close(),t.productList=a.data)})},addBrand(){this.brandStatus=!0,this.imgUrl="",this.brandModel={}},editBrand(t,e){this.brandModel=e,this.imgUrl=e.cover?this.filePath+e.cover:"",this.brandStatus=!0},addType(){this.typeModel={brand_id:this.selBrandId},this.imgTypeUrl="",this.typeStatus=!0},editType(t,e){this.imgTypeUrl=e.cover?this.filePath+e.cover:"",this.typeModel=e,this.typeStatus=!0},cancelBrand(){this.brandStatus=!1},sureBrand(){const t=this;this.$refs.brandForm.validate(e=>{if(e){let e=t.brandModel;e.id?n.g(e.id,e).then(e=>{const{data:a,status:s}=e;Object(r.a)(t,s,a)}):n.a(e).then(e=>{const{data:a,status:s}=e;Object(r.a)(t,s,a)&&t.getBrandList()}),t.brandStatus=!1}})},cancelType(){this.typeStatus=!1},sureType(){const t=this;this.$refs.typeForm.validate(e=>{if(e){let e=t.typeModel;e.id?n.h(e.id,e).then(e=>{const{data:a,status:s}=e;Object(r.a)(t,s,a)}):n.b(e).then(e=>{const{data:a,status:s}=e;Object(r.a)(t,s,a)&&t.getTypeList()}),t.typeStatus=!1}})},brandChange(t){t?(this.selBrandId=t.id,this.$refs.brandTable.setCurrentRow()):this.selBrandId="",this.getTypeList()},typeChange(t){this.selTypeId=t?t.id:"",this.getProductList()},formClose(){this.$refs.typeForm&&this.$refs.typeForm.clearValidate(),this.$refs.brandForm&&this.$refs.brandForm.clearValidate()},editProduct(t){t?this.$router.push({path:"/shopDetail",query:{scree:t}}):this.$router.push({path:"/shopDetail"})},handleAvatarSuccess(t,e){this.imgUrl=URL.createObjectURL(e.raw),this.brandModel.cover=t},handleTypeSuccess(t,e){this.imgTypeUrl=URL.createObjectURL(e.raw),this.typeModel.cover=t}}},c=(a(738),a(138)),u=Object(c.a)(d,s,[],!1,null,"70e28c9a",null);u.options.__file="src/app/views/shopManage/brand/brand.vue";e.default=u.exports}}]);